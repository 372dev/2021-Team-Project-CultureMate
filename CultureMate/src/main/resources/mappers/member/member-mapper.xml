<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.kh.cm.member.model.dao.MemberDao">

	<sql id="selectMemberSql">
		SELECT
				ID
				USER_ID,
				PASSWORD,
				USER_NICK,
				USER_NAME,
				USER_ROLE,
				DATE_BIRTH,
				GENDER,
				EMAIL,
				PHONE,
				POSTCODE,
				ADDRESS,
				DETAIL_ADDR,
				EXTRA_ADDR,
				RANK
		FROM MEMBER
		WHERE STATUS = 'Y'	
	</sql>
	
	<resultMap type="Member" id="memberResultMap">
		<id property="id" column="ID" />
		<result property="userId" column="USER_ID" />
		<result property="password" column="PASSWORD" />
		<result property="userNick" column="USER_NICK" />
		<result property="userName" column="USER_NAME" />
		<result property="userRole" column="USER_ROLE" />
		<result property="dateBirth" column="DATE_BIRTH" />
		<result property="gender" column="GENDER" />
		<result property="email" column="EMAIL" />
		<result property="phone" column="PHONE" />
		<result property="postcode" column="POSTCODE" />
		<result property="address" column="ADDRESS" />
		<result property="detailAddr" column="DETAIL_ADDR" />
		<result property="extraAddr" column="EXTRA_ADDR" />
		<result property="rank" column="RANK" />
		<result property="status" column="STATUS" />
	</resultMap>
	
	<select id="selectMember" parameterType="string" resultMap="memberResultMap">
		<include refid="selectMemberSql"></include>
		AND USER_ID = #{userId}
	</select>
	
	<select id="selectMemberAll" resultMap="memberResultMap">
		<include refid="selectMemberSql"></include>
	</select>
	
	<insert id="insertMember" parameterType="Member" useGeneratedKeys="true" keyProperty="id" keyColumn="ID">
		INSERT INTO MEMBER (
			ID,
			USER_ID,
			PASSWORD,
			USER_NICK,
			USER_NAME,
			USER_ROLE,
			DATE_BIRTH,
			GENDER,
			EMAIL,
			PHONE,
			POSTCODE,
			ADDRESS,
			DETAIL_ADDR,
			EXTRA_ADDR,
			RANK,
			STATUS
		) 
		VALUES (
			MEM_SEQ.NEXTVAL,
			#{userId},
			#{password},
			#{userNick},
			#{userName},
			DEFAULT,
			#{dateBirth},
			#{gender},
			#{email},
			#{phone},
			#{postcode},
			#{address},
			#{detailAddr},
			#{extraAddr},
			DEFAULT,
			DEFAULT
		)
	</insert>
	
	<update id="updateMember" parameterType="Member">
		UPDATE MEMBER
		SET
			PHONE = #{phone},
			EMAIL = #{email},
			POSTCODE = #{postcode},
			ADDRESS = #{address},
			DETAIL_ADDR = #{detailAddr},
			EXTRA_ADDR = #{extraAddr}
		WHERE
			ID = #{id}
	</update>
	
	<delete id="deleteMember" parameterType="String">
		UPDATE MEMBER SET STAUTS = 'N' WEHRE ID = #{id}
	</delete>
</mapper>
