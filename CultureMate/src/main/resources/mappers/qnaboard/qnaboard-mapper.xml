<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.kh.cm.qna.model.dao.QnaBoardDao">

<sql id="qnaBoardListSql">
		SELECT Q.QNA_ID,
			   M.USER_ID,
		       Q.QNA_TYPE,
		       Q.QNA_TITLE,
		       Q.QNA_CONTENT,
		       Q.QNA_CREATE_DATE,
		       Q.STATUS
		FROM QNA_BOARD Q
		JOIN MEMBER M ON(Q.QNA_WRITERNO = M.ID)		
		WHERE Q.STATUS ='Y'	
	</sql>

  <resultMap type="qnaBoard" id="qnaboardResultMap">
		<id property="qnaId" column="QNA_ID"/>
		<result property="userId" column="USER_ID"/>
		<result property="qnaType" column="QNA_TYPE"/>
		<result property="qnaTitle" column="QNA_TITLE"/>
		<result property="qnaContent" column="QNA_CONTENT"/>
		<result property="qnaCreateDate" column="QNA_CREATE_DATE"/>
	    <result property="status" column="STATUS"/>
	</resultMap>
	
	<resultMap type="qnaBoard" id="qnaboardDetailResultMap">
		<id property="qnaId" column="QNA_ID"/>
		<result property="userId" column="Q_USER_ID"/>
		<result property="qnaType" column="USER_ID"/>
		<result property="qnaTitle" column="QNA_TITLE"/>
		<result property="qnaContent" column="QNA_CONTENT"/>
		<result property="qnaCreateDate" column="QNA_CREATE_DATE"/>
		<result property="status" column="Q_STATUS"/>

	</resultMap>
	
	<select id="selectqnaBoardList" parameterType="map" resultMap="qnaboardResultMap">
		<include refid="qnaBoardListSql"></include>
		ORDER BY Q.QNA_ID DESC
	</select>
	
	<select id="selectCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM QNA_BOARD
		WHERE STATUS='Y'
	</select>	 	
	
	<select id="selectqnaBoardDetail" parameterType="_int" resultMap="qnaboardDetailResultMap">
		SELECT Q.QNA_ID,
		       M.USER_ID AS Q_USER_ID,
		       Q.QNA_TYPE,
		       Q.QNA_TITLE,
		       Q.QNA_CONTENT,
		       Q.QNA_CREATE_DATE,
		       Q.STATUS AS Q_STATUS
	      FROM QNA_BOARD Q
	      JOIN MEMBER M ON(Q.QNA_WRITERNO = M.ID)
	      WHERE Q.STATUS='Y' AND Q.QNA_ID=#{qnaId}
	</select>
	
	<insert id="insertqnaBoard" parameterType="map"
  		useGeneratedKeys="true" keyProperty="qnaId" keyColumn="QNA_ID" >
  		
  		INSERT INTO QNA_BOARD
        VALUES (
  			SEQ_QNA_ID.NEXTVAL,
	        #{qnaWriterNo},
  			#{qnaType},
  			#{qnaTitle},
  			#{qnaContent},
  			DEFAULT,
  			DEFAULT,
  			DEFAULT

 		)
  	</insert>
	
</mapper>